repositories:
  - name: traefik
    url: https://traefik.github.io/charts
  - name: metallb
    url: https://metallb.github.io/metallb
  - name: sealed-secrets
    url: https://bitnami-labs.github.io/sealed-secrets
  - name: longhorn
    url: https://charts.longhorn.io
  - name: twingate
    url: https://twingate.github.io/helm-charts
  - name: minio
    url: https://charts.min.io/
releases:
  - name: traefik
    namespace: traefik
    chart: traefik/traefik
    version: ~28.0.0
    values:
      - helm/values/traefik/values.yaml
    hooks:
      - events: ["presync"]
        showlogs: true
        command: "kubectl"
        args:
          - "apply"
          - "-f"
          - "middleware/traefik/dashboard-auth.yaml"
  - name: sealed-secrets
    namespace: sealed-secrets
    chart: sealed-secrets/sealed-secrets
    version: 2.17.9
    installed: true
    createNamespace: true
    values:
      - fullnameOverride: sealed-secrets
        rbac:
          create: true
  - name: longhorn
    namespace: longhorn-system
    chart: longhorn/longhorn
    version: ~1.6.0
    createNamespace: true
    values:
      - helm/values/longhorn/values.yaml
    hooks:
      - events: ["postsync"]
        showlogs: true
        command: "kubectl"
        args:
          [
            "wait",
            "--namespace=longhorn-system",
            "--for=condition=ready",
            "pod",
            "-l=app=longhorn-manager",
            "--timeout=300s",
          ]
  - name: twingate-master-connector-1
    namespace: twingate
    chart: twingate/connector
    values:
      - helm/values/twingate/values.yaml
    hooks:
      - events: ["presync"]
        showlogs: true
        command: "kubectl"
        args:
          - "apply"
          - "-f"
          - "manifests/namespaces/twingate.yaml"
      - events: ["presync"]
        showlogs: true
        command: "kubectl"
        args:
          - "apply"
          - "-f"
          - "manifests/secrets/sealed-secrets/sealed-secret-twingate-connector.yaml"
  - name: minio
    namespace: minio
    chart: minio/minio
    version: ~5.2.0
    values:
      - helm/values/minio/values.yaml
    hooks:
      - events: ["presync"]
        showlogs: true
        command: "kubectl"
        args:
          - "apply"
          - "-f"
          - "manifests/namespaces/minio.yaml"
      - events: ["presync"]
        showlogs: true
        command: "kubectl"
        args:
          - "apply"
          - "-f"
          - "manifests/secrets/sealed-secrets/sealed-secret-minio-credentials.yaml"
